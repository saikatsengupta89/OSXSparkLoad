package sumx_aggregate

import org.apache.log4j._
import org.apache.spark.SparkConf;
import org.apache.spark.sql.DataFrame 
import org.apache.spark.sql.internal.SQLConf.WHOLESTAGE_CODEGEN_ENABLED

/* for writing logs w.r.t. data load process */
import java.io._
import java.text.SimpleDateFormat
import java.util.{Calendar, Date}
import org.apache.spark.sql.SQLContext

object load_total_lines {
  
    
    def osx_seg_gl_tot_lines_load (sqlContext:SQLContext, 
                                   gl_agg_final:DataFrame, 
                                   dom:DataFrame, 
                                   acc:DataFrame, 
                                   pc:DataFrame,
                                   hdfs_gl_agg:String):DataFrame={
         
         gl_agg_final.registerTempTable("OSX_SEG_GL_AGG")
         acc.registerTempTable("OSX_GL_ACC_FPA")
         pc.registerTempTable("OSX_PROFIT_CENTRE")
         
         println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINES POPULATION INITIATED")
         //pw.println(process_sumx_agg.time+" "+" OSX GL - TOTAL LINES POPULATION INITIATED")
         
         /***************INVESTMENTS-13000********************/
         val tot_13000= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES'DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-13000'GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL2_CODE = '10300000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-13000', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")
         
         println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 13000 DATAFRAME CREATED")
         //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 13000 DATAFRAME CREATED")
         
         /***************NET LOANS-13001********************/
         val tot_13001= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES'DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-13001'GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL4_CODE IN ('10511000','10512000','10521000') "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-13001', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")
              
         println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 13001 DATAFRAME CREATED")
         //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 13001 DATAFRAME CREATED")
              
         /****************TOTAL ASSETS-13002******************/
         val tot_13002= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES'DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-13002'GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL1_CODE='10000000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-13002', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")
              
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 13002 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 13002 DATAFRAME CREATED")
              
          /****************TOTAL LIABILITIES-13003******************/
          val tot_13003= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-13003' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL1_CODE IN ('30000000','35000000') "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-13003', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")    
              
         println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 13003 DATAFRAME CREATED") 
         //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 13003 DATAFRAME CREATED")
              
              
          /****************PERFORMING LOANS-13004******************/
          val tot_13004= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-13004' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL4_CODE='10511000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-13004', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 13004 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 13004 DATAFRAME CREATED")
          
          /****************CUSTOMER DEPOSITS-13005******************/
          val tot_13005= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-13005' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL2_CODE='30300000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-13005', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")
          
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 13005 DATAFRAME CREATED")    
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 13005 DATAFRAME CREATED")
              
          /****************TOTAL ASSETS-13008******************/
          val tot_13008= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-13008' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE ((B.GL_ACCOUNT_LEVL2_CODE ='10300000') OR "+
              "           (B.GL_ACCOUNT_LEVL2_CODE = '30100000' AND B.GL_ACCOUNT_LEVL3_CODE = '30130000') "+
              "      ) "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-13008', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")    
          
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 13008 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 13008 DATAFRAME CREATED")
          
          /****************TOTAL EARNING ASSETS-13010******************/
          val tot_13010= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-13010' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL1_CODE='10000000' "+
              "AND B.GL_ACCOUNT_LEVL2_CODE NOT IN ('10600000','10700000','10800000','10900000','10100000','11000000') "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-13010', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")
          
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 13010 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 13010 DATAFRAME CREATED")
                   
          /****************TOTAL INTEREST BEARING LIABILITIES -13011******************/
          val tot_13011= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-13011' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL1_CODE IN ('30000000','35000000') "+
              "AND B.GL_ACCOUNT_LEVL2_CODE NOT IN ('30400000','30500000','30600000','35000000') "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-13011', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")    
          
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 13011 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 13011 DATAFRAME CREATED")
          
          /****************NET INTEREST INCOME -67001******************/
          val tot_67001= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67001' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL2_CODE = '60100000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67001', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")     
          
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67001 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67001 DATAFRAME CREATED")
              
          /****************TOTAL INTEREST BEARING LIABILITIES -67002******************/
          val tot_67002= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67002' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL3_CODE ='60210000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67002', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY") 
          
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67002 DATAFRAME CREATED")    
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67002 DATAFRAME CREATED")
          
          /****************NON FUND INCOME -67003******************/
          val tot_67003= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67003' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL2_CODE ='60200000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67003', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY") 
          
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67003 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67003 DATAFRAME CREATED")
          
          /****************OPERATING INCOME -67004******************/
          val tot_67004= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67004' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE B.GL_ACCOUNT_LEVL1_CODE ='60000000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67004', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY")     
          
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67004 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67004 DATAFRAME CREATED")
          
          /****************BUSINESS DIRECT COST -67005******************/
          val tot_67005= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67005' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE "+
              "(B.GL_ACCOUNT_LEVL1_CODE = '70000000' AND "+
              " B.GL_ACCOUNT_LEVL3_CODE = '70310000' AND "+ 
              " B.GL_ACCOUNT_LEVL5_CODE <> '70314100' OR "+
              "   (B.GL_ACCOUNT_LEVL1_CODE = '70000000' AND "+ 
              "    B.GL_ACCOUNT_LEVL3_CODE = '70310000' AND  "+
              "    B.GL_ACCOUNT_LEVL5_CODE <> '70314100' AND "+
              "    A.SOURCE_SYSTEM_ID IN ('TI','MM') "+
              "   ) "+
              ") "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67005', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY"
          )
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67005 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67005 DATAFRAME CREATED")
          
          /****************OPERATING EXPENSES -67006******************/
          val tot_67006= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67006' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "INNER JOIN OSX_PROFIT_CENTRE C ON A.PROFIT_CENTRE=C.PROFIT_CENTRE_CD "+
              "WHERE "+
              "CASE WHEN B.GL_ACCOUNT_LEVL1_CODE='70000000' "+ 
              "THEN CASE WHEN B.GL_ACCOUNT_LEVL5_CODE='70314100' "+
              "          THEN CASE WHEN C.PROFIT_CENTRE_CD='21010' THEN 1 ELSE 0 END "+
              "          ELSE 1 END "+
              "     ELSE 0 END=1 "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67006', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY"
          )
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67006 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67006 DATAFRAME CREATED")
          
          /****************OPERATING PROFIT -67007******************/
          val tot_67007= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67007' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE "+
              "(B.GL_ACCOUNT_LEVL1_CODE IN ('70000000','60000000') AND "+
              " B.GL_ACCOUNT_LEVL5_CODE <> '70314100' OR "+
              "    (B.GL_ACCOUNT_LEVL1_CODE = '70000000' AND "+ 
              "     B.GL_ACCOUNT_LEVL5_CODE = '70314100' AND "+
              "     A.SOURCE_SYSTEM_ID IN ('T24','TI','OGL','MM') "+
              "    ) "+
              ") "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67007', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY"
          )
          
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67007 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67007 DATAFRAME CREATED")
          
          /****************IMPAIRMENT -67008******************/
          val tot_67008= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67008' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE "+
              "B.GL_ACCOUNT_LEVL1_CODE ='77000000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67008', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY"
          )
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67008 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67008 DATAFRAME CREATED")
          
          /****************TAX -67009******************/
          val tot_67009= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67009' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE "+
              "B.GL_ACCOUNT_LEVL1_CODE ='78000000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67009', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY"
          )
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67009 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67009 DATAFRAME CREATED")
          
          /****************NPBT -67010******************/
          val tot_67010= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67010' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "INNER JOIN OSX_PROFIT_CENTRE C ON A.PROFIT_CENTRE= C.PROFIT_CENTRE_CD AND A.LEGAL_ENTITY= C.ENTITY "+
              "WHERE "+
              "B.GL_ACCOUNT_LEVL1_CODE ='77000000' "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67010', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY"
          )
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67010 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67010 DATAFRAME CREATED")
          
          /****************NPBT -67011******************/
          val tot_67011= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67011' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "INNER JOIN OSX_PROFIT_CENTRE C ON A.PROFIT_CENTRE= C.PROFIT_CENTRE_CD AND A.LEGAL_ENTITY= C.ENTITY "+
              "WHERE "+
              "CASE WHEN B.GL_ACCOUNT_LEVL1_CODE in ('60000000','70000000','77000000','78000000') "+
              "     THEN CASE WHEN B.GL_ACCOUNT_LEVL5_CODE='70314100' "+
              "               THEN CASE WHEN C.PROFIT_CENTRE_CD='21010' THEN 1 "+ 
              "                         ELSE 0 END "+
              "               ELSE 1 END "+
              "     ELSE 0 END=1 "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67011', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY"
          )
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67011 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67011 DATAFRAME CREATED")
          
          /****************NET PROFIT AFTER EQUITY CHARGE -67013******************/
          val tot_67013= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67013' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "INNER JOIN OSX_PROFIT_CENTRE C ON A.PROFIT_CENTRE= C.PROFIT_CENTRE_CD AND A.LEGAL_ENTITY= C.ENTITY "+
              "WHERE "+
              "CASE WHEN B.GL_ACCOUNT_LEVL1_CODE IN ('60000000','70000000','77000000','78000000','79000000') "+
              "    THEN CASE WHEN B.GL_ACCOUNT_LEVL5_CODE='70314100' "+
              "              THEN CASE WHEN C.PROFIT_CENTRE_CD='21010' THEN 1 ELSE 0 END "+
              "              ELSE 1 END "+
              "    ELSE 0 END=1 "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67013', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY"
          )
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67013 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67013 DATAFRAME CREATED")
                    
          /****************RWA -67016******************/
          val tot_67016= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67016' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "WHERE "+
              "A.GL_ACCOUNT_ID NOT LIKE '-%' "+
              "AND (A.DOMAIN_ID IN ('19','20','21') "+
              "     OR "+
              "    (A.DOMAIN_ID IN ('50','51','52') AND A.GL_ACCOUNT_ID IN ('913716','813714','813715')) "+
              "    ) "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67016', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY"
          )
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67016 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67016 DATAFRAME CREATED")
          
          /****************NET PROFIT AFTER AMORTIZATION -67017******************/
          val tot_67017= sqlContext.sql(
              "SELECT "+
              "A.AMOUNT_CLASS, "+
              "A.BANKING_TYPE, "+
              "NULL BANKING_TYPE_CUSTOMER, "+
              "A.CATEGORY_CODE, "+
              "NULL CURRENCY_CODE, "+
              "A.CUSTOMER_SEGMENT_CODE, "+
              "'TOTAL LINES' DATASET, "+
              "A.DOMAIN_ID, "+
              "A.FINAL_SEGMENT, "+
              "'-67017' GL_ACCOUNT_ID, "+
              "A.IS_INTERNAL_ACCOUNT, "+
              "A.LEGAL_ENTITY, "+
              "A.PROFIT_CENTRE, "+
              "NULL SOURCE_SYSTEM_ID, "+
              "A.TIME_KEY, "+
              "SUM(A.ASSET_COF) ASSET_COF, "+
              "SUM(A.ASSET_COF_MTD_LCY) ASSET_COF_MTD_LCY, "+
              "SUM(A.ASSET_COF_YTD_AED) ASSET_COF_YTD_AED, "+
              "SUM(A.ASSET_COF_YTD_LCY) ASSET_COF_YTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL) AVG_BOOK_BAL, "+
              "SUM(A.AVG_BOOK_BAL_MTD_LCY) AVG_BOOK_BAL_MTD_LCY, "+
              "SUM(A.AVG_BOOK_BAL_YTD_AED) AVG_BOOK_BAL_YTD_AED, "+
              "SUM(A.AVG_BOOK_BAL_YTD_LCY) AVG_BOOK_BAL_YTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_MTD_AED) CY_ED_BUDGET_MTD_AED, "+
              "SUM(A.CY_ED_BUDGET_MTD_LCY) CY_ED_BUDGET_MTD_LCY, "+
              "SUM(A.CY_ED_BUDGET_YTD_AED) CY_ED_BUDGET_YTD_AED, "+
              "SUM(A.CY_ED_BUDGET_YTD_LCY) CY_ED_BUDGET_YTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME) DERIVATIVES_INCOME, "+
              "SUM(A.DERIVATIVES_INCOME_MTD_LCY) DERIVATIVES_INCOME_MTD_LCY, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_AED) DERIVATIVES_INCOME_YTD_AED, "+
              "SUM(A.DERIVATIVES_INCOME_YTD_LCY) DERIVATIVES_INCOME_YTD_LCY, "+
              "SUM(A.FEE_INCOME) FEE_INCOME, "+
              "SUM(A.FEE_INCOME_MTD_LCY) FEE_INCOME_MTD_LCY, "+
              "SUM(A.FEE_INCOME_YTD_AED) FEE_INCOME_YTD_AED, "+
              "SUM(A.FEE_INCOME_YTD_LCY) FEE_INCOME_YTD_LCY, "+
              "SUM(A.FX_INCOME) FX_INCOME, "+
              "SUM(A.FX_INCOME_MTD_LCY) FX_INCOME_MTD_LCY, "+
              "SUM(A.FX_INCOME_YTD_AED) FX_INCOME_YTD_AED, "+
              "SUM(A.FX_INCOME_YTD_LCY) FX_INCOME_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE) GROSS_INTEREST_EXPENSE, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_MTD_LCY) GROSS_INTEREST_EXPENSE_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_AED) GROSS_INTEREST_EXPENSE_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_EXPENSE_YTD_LCY) GROSS_INTEREST_EXPENSE_YTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME) GROSS_INTEREST_INCOME, "+
              "SUM(A.GROSS_INTEREST_INCOME_MTD_LCY) GROSS_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_AED) GROSS_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.GROSS_INTEREST_INCOME_YTD_LCY) GROSS_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE) INTERBRANCH_EXPENSE, "+
              "SUM(A.INTERBRANCH_EXPENSE_MTD_LCY) INTERBRANCH_EXPENSE_MTD_LCY, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_AED) INTERBRANCH_EXPENSE_YTD_AED, "+
              "SUM(A.INTERBRANCH_EXPENSE_YTD_LCY) INTERBRANCH_EXPENSE_YTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME) INTERBRANCH_INCOME, "+
              "SUM(A.INTERBRANCH_INCOME_MTD_LCY) INTERBRANCH_INCOME_MTD_LCY, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_AED) INTERBRANCH_INCOME_YTD_AED, "+
              "SUM(A.INTERBRANCH_INCOME_YTD_LCY) INTERBRANCH_INCOME_YTD_LCY, "+
              "SUM(A.LIABILITY_COF) LIABILITY_COF, "+
              "SUM(A.LIABILITY_COF_MTD_LCY) LIABILITY_COF_MTD_LCY, "+
              "SUM(A.LIABILITY_COF_YTD_AED) LIABILITY_COF_YTD_AED, "+
              "SUM(A.LIABILITY_COF_YTD_LCY) LIABILITY_COF_YTD_LCY, "+
              "SUM(A.LP_CHARGE) LP_CHARGE, "+
              "SUM(A.LP_CHARGE_MTD_LCY) LP_CHARGE_MTD_LCY, "+
              "SUM(A.LP_CHARGE_YTD_AED) LP_CHARGE_YTD_AED, "+
              "SUM(A.LP_CHARGE_YTD_LCY) LP_CHARGE_YTD_LCY, "+
              "SUM(A.LP_CREDIT) LP_CREDIT, "+
              "SUM(A.LP_CREDIT_MTD_LCY) LP_CREDIT_MTD_LCY, "+
              "SUM(A.LP_CREDIT_YTD_AED) LP_CREDIT_YTD_AED, "+
              "SUM(A.LP_CREDIT_YTD_LCY) LP_CREDIT_YTD_LCY, "+
              "SUM(A.MTD_AED) MTD_AED, "+
              "SUM(A.MTD_AED_ACTUAL) MTD_AED_ACTUAL, "+
              "SUM(A.MTD_AED_BUDGET) MTD_AED_BUDGET, "+
              "SUM(A.MTD_LCY) MTD_LCY, "+
              "SUM(A.MTD_LCY_ACTUAL) MTD_LCY_ACTUAL, "+
              "SUM(A.MTD_LCY_BUDGET) MTD_LCY_BUDGET, "+
              "SUM(A.NET_INT_MARGIN) NET_INT_MARGIN, "+
              "SUM(A.NET_INT_MARGIN_MTD_LCY) NET_INT_MARGIN_MTD_LCY, "+
              "SUM(A.NET_INT_MARGIN_YTD_AED) NET_INT_MARGIN_YTD_AED, "+
              "SUM(A.NET_INT_MARGIN_YTD_LCY) NET_INT_MARGIN_YTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME) NET_INTEREST_INCOME, "+
              "SUM(A.NET_INTEREST_INCOME_MTD_LCY) NET_INTEREST_INCOME_MTD_LCY, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_AED) NET_INTEREST_INCOME_YTD_AED, "+
              "SUM(A.NET_INTEREST_INCOME_YTD_LCY) NET_INTEREST_INCOME_YTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME) NET_INVESTMENT_INCOME, "+
              "SUM(A.NET_INVESTMENT_INCOME_MTD_LCY) NET_INVESTMENT_INCOME_MTD_LCY, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_AED) NET_INVESTMENT_INCOME_YTD_AED, "+
              "SUM(A.NET_INVESTMENT_INCOME_YTD_LCY) NET_INVESTMENT_INCOME_YTD_LCY, "+
              "SUM(A.NET_PL) NET_PL, "+
              "SUM(A.NET_PL_MTD_LCY) NET_PL_MTD_LCY, "+
              "SUM(A.NET_PL_YTD_AED) NET_PL_YTD_AED, "+
              "SUM(A.NET_PL_YTD_LCY) NET_PL_YTD_LCY, "+
              "SUM(A.OTHER_INCOME) OTHER_INCOME, "+
              "SUM(A.OTHER_INCOME_MTD_LCY) OTHER_INCOME_MTD_LCY, "+
              "SUM(A.OTHER_INCOME_YTD_AED) OTHER_INCOME_YTD_AED, "+
              "SUM(A.OTHER_INCOME_YTD_LCY) OTHER_INCOME_YTD_LCY, "+
              "SUM(A.RWA_CREDIT_RISK) RWA_CREDIT_RISK, "+
              "SUM(A.RWA_MARKET_RISK) RWA_MARKET_RISK, "+
              "SUM(A.RWA_OPERATIONAL_RISK) RWA_OPERATIONAL_RISK, "+
              "SUM(A.RWA_TOTAL) RWA_TOTAL, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_AED) TOTAL_FTP_AMT_MTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_MTD_LCY) TOTAL_FTP_AMT_MTD_LCY, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_AED) TOTAL_FTP_AMT_YTD_AED, "+
              "SUM(A.TOTAL_FTP_AMT_YTD_LCY) TOTAL_FTP_AMT_YTD_LCY, "+
              "SUM(A.YTD_AED) YTD_AED, "+
              "SUM(A.YTD_AED_ACTUAL) YTD_AED_ACTUAL, "+
              "SUM(A.YTD_AED_BUDGET) YTD_AED_BUDGET, "+
              "SUM(A.YTD_LCY) YTD_LCY, "+
              "SUM(A.YTD_LCY_ACTUAL) YTD_LCY_ACTUAL, "+
              "SUM(A.YTD_LCY_BUDGET) YTD_LCY_BUDGET, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_AED) PREV_YR_CURR_MTH_YTD_AED, "+
              "SUM(A.PREV_YR_CURR_MTH_YTD_LCY) PREV_YR_CURR_MTH_YTD_LCY, "+
              "SUM(A.PREV_MTH1_MTD_AED) PREV_MTH1_MTD_AED, "+
              "SUM(A.PREV_MTH1_MTD_LCY) PREV_MTH1_MTD_LCY, "+
              "SUM(A.PREV_MTH2_MTD_AED) PREV_MTH2_MTD_AED, "+
              "SUM(A.PREV_MTH2_MTD_LCY) PREV_MTH2_MTD_LCY, "+
              "NULL GM_STMT_DERIVATIVES, "+
              "NULL GM_OTHER "+
              "FROM OSX_SEG_GL_AGG A "+
              "INNER JOIN OSX_GL_ACC_FPA B ON A.GL_ACCOUNT_ID=B.GL_ACCOUNT_ID "+
              "WHERE "+
              "B.GL_ACCOUNT_LEVL1_CODE IN ('60000000','70000000','77000000','78000000','79000000') "+
              "GROUP BY A.AMOUNT_CLASS,A.BANKING_TYPE, NULL ,A.CATEGORY_CODE, NULL, A.CUSTOMER_SEGMENT_CODE,'TOTAL LINES',A.DOMAIN_ID,A.FINAL_SEGMENT, "+
              "'-67017', A.IS_INTERNAL_ACCOUNT,A.LEGAL_ENTITY,A.PROFIT_CENTRE,A.SOURCE_SYSTEM_ID,A.TIME_KEY"
          )
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - TOTAL LINE 67017 DATAFRAME CREATED")
          //pw.println(process_sumx_agg.time+" "+" GL AGG - TOTAL LINE 67017 DATAFRAME CREATED")
          
          val gl_agg_tot= tot_13000.unionAll(tot_13001)
                                   .unionAll(tot_13002)
                                   .unionAll(tot_13003)
                                   .unionAll(tot_13004)
                                   .unionAll(tot_13005)
                                   .unionAll(tot_13008)
                                   .unionAll(tot_13010)
                                   .unionAll(tot_13011)
                                   .unionAll(tot_67001)
                                   .unionAll(tot_67002)
                                   .unionAll(tot_67003)
                                   .unionAll(tot_67004)
                                   .unionAll(tot_67005)
                                   .unionAll(tot_67006)
                                   .unionAll(tot_67007)
                                   .unionAll(tot_67008)
                                   .unionAll(tot_67009)
                                   .unionAll(tot_67010)
                                   .unionAll(tot_67011)
                                   .unionAll(tot_67013)
                                   .unionAll(tot_67016)
                                   .unionAll(tot_67017)
          
          println(process_sumx_agg.time+" "+"OSX GL AGG - ALL TOTAL LINE DATAFRAMES UNION DONE")                         
          //pw.println(process_sumx_agg.time+" "+" GL AGG - ALL TOTAL LINE DATAFRAMES UNION DONE")
           
          return gl_agg_tot
    }
    
  
}
